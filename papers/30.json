{"metadata": {"Content-Type": "application/pdf", "Creation-Date": "2012-10-09T11:57:59Z", "Last-Modified": "2012-09-10T06:16:42Z", "Last-Save-Date": "2012-09-10T06:16:42Z", "X-Parsed-By": ["org.apache.tika.parser.DefaultParser", "org.apache.tika.parser.pdf.PDFParser"], "X-TIKA:content_handler": "ToTextContentHandler", "X-TIKA:embedded_depth": "0", "X-TIKA:parse_time_millis": "96", "access_permission:assemble_document": "true", "access_permission:can_modify": "true", "access_permission:can_print": "true", "access_permission:can_print_degraded": "true", "access_permission:extract_content": "true", "access_permission:extract_for_accessibility": "true", "access_permission:fill_in_form": "true", "access_permission:modify_annotations": "true", "created": "2012-10-09T11:57:59Z", "date": "2012-09-10T06:16:42Z", "dc:format": "application/pdf; version=1.5", "dc:title": "pcbi.1002719 1..12", "dcterms:created": "2012-10-09T11:57:59Z", "dcterms:modified": "2012-09-10T06:16:42Z", "meta:creation-date": "2012-10-09T11:57:59Z", "meta:save-date": "2012-09-10T06:16:42Z", "modified": "2012-09-10T06:16:42Z", "pdf:PDFVersion": "1.5", "pdf:charsPerPage": ["5237", "6282", "3583", "820", "6629", "575", "5938", "5835", "4529", "6355", "5723", "5257"], "pdf:docinfo:created": "2012-10-09T11:57:59Z", "pdf:docinfo:creator_tool": "3B2 Total Publishing System 7.51n/W", "pdf:docinfo:modified": "2012-09-10T06:16:42Z", "pdf:docinfo:producer": "Acrobat Distiller 9.0.0 (Windows)", "pdf:docinfo:title": "pcbi.1002719 1..12", "pdf:encrypted": "false", "pdf:hasMarkedContent": "false", "pdf:hasXFA": "false", "pdf:hasXMP": "true", "pdf:unmappedUnicodeCharsPerPage": ["1", "6", "1", "0", "2", "0", "8", "6", "2", "0", "0", "0"], "producer": "Acrobat Distiller 9.0.0 (Windows)", "resourceName": "b'30.pdf'", "title": "pcbi.1002719 1..12", "xmp:CreatorTool": "3B2 Total Publishing System 7.51n/W", "xmpMM:DocumentID": "uuid:64f62207-9c29-4605-8e9a-b5e417584e19", "xmpTPg:NPages": "12"}, "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npcbi.1002719 1..12\n\n\nPredictive Dynamics of Human Pain Perception\nGuillermo A. Cecchi1*, Lejian Huang2, Javeria Ali Hashmi2, Marwan Baliki2, Mar\u0131\u0301a V. Centeno2, Irina Rish1,\n\nA. Vania Apkarian2*\n\n1 Computational Biology Center, T.J. Watson IBM Research Laboratory, Yorktown Heights, New York, United States of America, 2 Department of Physiology, Feinberg\n\nSchool of Medicine, Northwestern University, Chicago, Illinois, United States of America\n\nAbstract\n\nWhile the static magnitude of thermal pain perception has been shown to follow a power-law function of the temperature,\nits dynamical features have been largely overlooked. Due to the slow temporal experience of pain, multiple studies now\nshow that the time evolution of its magnitude can be captured with continuous online ratings. Here we use such ratings to\nmodel quantitatively the temporal dynamics of thermal pain perception. We show that a differential equation captures the\ndetails of the temporal evolution in pain ratings in individual subjects for different stimulus pattern complexities, and also\ndemonstrates strong predictive power to infer pain ratings, including readouts based only on brain functional images.\n\nCitation: Cecchi GA, Huang L, Hashmi JA, Baliki M, Centeno MV, et al. (2012) Predictive Dynamics of Human Pain Perception. PLoS Comput Biol 8(10): e1002719.\ndoi:10.1371/journal.pcbi.1002719\n\nEditor: Abigail Morrison, Research Center Ju\u0308lich, Germany\n\nReceived March 1, 2012; Accepted August 15, 2012; Published October 25, 2012\n\nCopyright: \ufffd 2012 Cecchi et al. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits\nunrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.\n\nFunding: This study was funded in part by NINDS NS35115 (AVA). The funders had no role in study design, data collection and analysis, decision to publish, or\npreparation of the manuscript.\n\nCompeting Interests: The authors have declared that no competing interests exist.\n\n* E-mail: gcecchi@us.ibm.com (GAC); a-apkarian@northwestern.edu (AVA)\n\nIntroduction\n\nAny scientific or philosophical examination of human percep-\n\ntion invariably must take into consideration the long-lasting notion\n\nof the subjectivity of pain. Plato, Aristotle, Galen, and Darwin\n\nexcluded pain from other sensory modalities and instead classified\n\nit with emotions. Avicenna (or Ibn Sina), the 11\nth\n\ncentury Arab-\n\nPersian philosopher-physician, is credited to be the first to suggest\n\npain as a specific skin sense; this idea was later reformulated by\n\nDescartes, who conceptualized pain signaling from the skin to the\n\nbrain [1,2]. The notion of subjectivity and thus incommunicability\n\nof personal pain was seminal in Wittgenstein\u2019s abandonment of\n\nlogic and shifting the emphasis of 20th century philosophical\n\ninquiry towards the study of language, in order to understand how\n\nsuch a private experience can be communicated at all [3]. More\n\nrecently, D. Dennett has argued, based on modern neuro-scientific\n\nunderstanding that due to its subjective nature, and in contrast to\n\nvisual perception, pain cannot be captured in computational\n\nmodels [4]. Indeed, the official definition of pain as accepted by\n\nthe International Association for the Study of Pain states that pain\n\nis \u2018\u2018an unpleasant sensory and emotional experience\u2019\u2019, and\n\nexpands to assert that, \u2018\u2018pain is always subjective\u2019\u2019 [5].\n\nIn contrast, psychophysics from its inception in the 19th century\n\nhas attempted to demonstrate that at least parts of human\n\nexperience/perception can be captured quantitatively and de-\n\nscribed with simple models. Beginning with the work of E.H.\n\nWeber and culminating with S.S. Stevens\u2019s law of magnitude\n\nperception, statistical properties of pain have been quantified and\n\nmodeled using simple equations [6\u20138]. Currently, statistics of pain\n\nare most commonly quantified with questionnaire-based tools, and\n\nthese remain the main instruments with which efficacy of pain\n\ntherapies are studied in clinical trials, for example [9,10].\n\nTemporal profiles of pain perception, however, have been seldom\n\nstudied [11\u201313]. Yet, with the advent of human brain imaging\n\ntechnology the need for tracking pain perception in time prompted\n\na number of groups to study pain perception as a time-evolving\n\nphenomenon [14\u201317].\n\nA result that has surprised the pain research community is the\n\npresence of strong temporal non-linearities in the relationship\n\nbetween the stimulus pattern and the corresponding ratings,\n\nincluding illusory perception of heat and warmth [16] which do\n\nnot appear to fit any cogent framework and yet can be linked to\n\nbrain activity [18,19]. With this as a starting point, we treat here\n\ntime evolution of acute thermal pain perception as a dynamical\n\nsystem described by differential equations, the properties of which\n\nprovide a general summary of the transformation of thermal heat\n\nparameters to pain perception space. Surprisingly, simple and\n\ninterpretable first- and second-order differential equations with\n\nvery few parameters accurately model time variability of pain\n\nperception in humans elicited by thermal stimulation patterns of\n\nvarying complexity. The equations can be used to infer with high\n\naccuracy the response of individuals in modeling conditions that\n\ninclude access to the stimulus temperature and in \u2018mind reading\u2019\n\nsetups, i.e. when pain perception is solely inferred from functional\n\nimages of the brain aided by the derived equations.\n\nResults\n\nPsychophysics Modeling\nGiven that perception of pain is a slow event and can be rated\n\ncontinuously, online continuous ratings of thermal pain can be\n\nreadily generated [14\u201317]. When the stimulus intensity on the skin\n\nis monitored together with the resultant ratings of pain, one can\n\nview this as a system identification problem where the input and\n\noutput are continuous time varying variables.\n\nWe reason that behavioral and evolutionary constraints require\n\nthermal pain to display three basic features. First and foremost,\n\nit must signal the threat of tissue damage: this is obviously\n\nPLOS Computational Biology | www.ploscompbiol.org 1 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\ndetermined by the current value of the skin temperature. The\n\nsignal magnitude must monotonically increase with the temper-\n\nature, although not necessarily linearly (as in fact, tissue damage is\n\nnot linear with temperature). Following standard psychophysical\n\npractice, we consider the perceived magnitude of pain to be a\n\npositive quantity, i.e. we exclude the possibility of negative pain.\n\nSecondly, this magnitude must anticipate the possibility of\n\ndamage, sounding the alarm of an imminent threat given the\n\nrecent history of temperature values, independently of the current\n\ntemperature. This information can be partially captured by the\n\nrate of change of the skin temperature. Finally, given its powerful\n\nhold on behavior, the intensity of pain perception must quickly\n\ndecay once the threat of damage disappears, so as not to interfere\n\nwith ongoing mental states [20,21]. Following these basic\n\nprinciples, we model pain perception as a dynamical system using\n\na second-order differential equation:\n\n\u20acpp(t)~aF (T(t),T0){b _pp(t)zc( _TT(t){l)p(t) \u00f01\u00de\n\nHere p(t) is the instantaneous perception of pain at time t, T(t) is\n\nthe temperature, \u20acpp(t)~\nd\n\ndt\n\ndp\n\ndt\n\n\ufffd \ufffd\nis the pain acceleration, _pp(t)~\n\ndp\n\ndt\n\nand _TT(t)~\ndT\n\ndt\nare, respectively, the pain\u2019s and temperature\u2019s rates\n\nof change. We explicitly constrain the dynamics to maintain the\n\nnon-negativity of perception, p(t)\u00a70, by imposing the boundary\ncondition p(t)v0[ _pp(t)~0.\n\nThe quantities T0,a,b,c,l are subject-specific constants. The\nfirst term in the right-hand-side represents the temperature-\n\ndependent \u2018\u2018force\u2019\u2019, whose functional form we model, for the sake\n\nof parsimony, with a step function (Figure 1 inset):\nT\u00a7T0[F (T ,T0)~T{T0,TvT0[F(T ,T0)~0, that is, the\nacceleration of the perception of pain takes effect only after the\n\nthreshold T0 is exceeded. The second term is the decay of pain or\n\u2018\u2018forgetting\u2019\u2019, which helps perception return to its minimal value\n\nupon the removal of the injury threat presented by TwT0, and\nalso dampens the oscillations that naturally arise in a second-order\n\ndynamical system. The constant b has units of 1/time, and\ntherefore 1=b can be considered the time scale of the forgetting\nprocess. The third and last term is less intuitive, but equally\n\nmeaningful from a functional perspective. It can be thought of as a\n\ndynamic restoring force, similar to the elastic term in the equation\n\nthat describes a mechanical oscillator. When the derivative of the\n\ntemperature is small enough, the term is negative and has the\n\neffect of limiting the pain level upon the continuing presence of a\n\nsupra-threshold stimulus, as well as eliminating any sub-threshold\n\npain fluctuations. When the temperature changes quickly,\n\nhowever, the effect of this term is more interesting. In the event\n\nof a temperature increase, the term becomes a driving force that\n\nhelps accelerate the perception of pain, to build up an alerting\n\nsignal that anticipates the upcoming threat of the temperature\n\nreaching and surpassing the injury threshold. Similarly, when the\n\ntemperature drops fast, the term becomes a restoring force,\n\npushing pain perception faster than the decay term and the passive\n\nrestoring force would allow. Notice that this creates an asymmetry\n\nin the rise and fall time-constants, even when the rate of\n\ntemperature change is the same in absolute terms: if the\n\ntemperature drops when the pain perception is high, the\n\nrestoration is much faster than the rise, for a similar rate of\n\nchange of the temperature. The constant c determines the\nintensity of the restoring/driving force, while l can be considered\nas a threshold above which fast changes in temperature become\n\nalarming.\n\nThe different effects of the three terms are illustrated in\n\nFigure 1, which depicts the evolution of pain perception averaged\nacross subjects (blue trace) upon the presentation of an evolving\n\ntemperature stimulus (dashed trace) (figure 7, from [16]; corre-\n\nsponding to our complex stimulus) and the best-fit inferred model\n\n(red trace). The temperature forcing term provides the basic effect\n\nof quickly increasing the magnitude of pain perception (first arrow\n\non the left). An equilibrium intensity is reached by the combined\n\nlimiting effects of the restoring force and the decay term (second\n\narrow). The active form of restoring force (i.e. when _TT=0) is most\nevident in the effect of the small kinks in temperature (third and\n\nfourth arrows).\n\nIn order to understand to what extent the complexity of the\n\nsecond-order dynamical system of Eq. 1 is warranted and the fit to\n\nthe psychophysical pain ratings significant, we considered two null\n\nhypotheses and a model simplification to contrast our results. In\n\nthe first place, we reasoned that the simplest approach for the\n\nnervous system to report thermal pain is by a direct correlation\n\nwith the temperature, i.e. p(T)!T . This null hypothesis is, in fact,\ntoo simple: the linear proportionality implies that temperatures a\n\nfew degrees below the skin injury threshold will be reported only\n\nwith proportionally weaker intensity than those a few degrees\n\nabove the threshold. Alternatively, we considered a model in\n\nwhich perception is linearly proportional to the temperature, but\n\nonly once it has exceeded a subject-dependent threshold. For\n\nobvious reasons, we termed these two null hypotheses as the linear\n\nand threshold-linear models, respectively; in the latter case, the\n\ntemperature threshold is estimated by optimizing the correlation\n\nbetween model and data. The linear null hypothesis has several\n\ndisadvantages; most glaring among them is the fact that it reports\n\nsub-threshold temperatures, which do not necessarily pose a threat\n\nof injury, almost as intensely as those that do pose a threat.\n\nSimilarly, the threshold-linear model is impervious to events that\n\nfall below threshold but may signal an imminent threat, such as a\n\nsudden increase in temperature. To further probe the significance\n\nof our model, therefore, we considered a simpler first-order system\n\nderived from Eq. 1, assuming that the following conditions are\n\nsatisfied: (a) the decay constant is sufficiently large, b&1 (i.e. the\ntime scale 1=b is short), and (b) the effect of the rate of change of\nthe temperature is not significant, l&1. Simple algebra leads then\nto the following first-order differential equation:\n\n_pp(t)~\ufffdaaF (T(t),T0){\ufffdccp(t) \u00f02\u00de\n\nWhere \ufffdaa and \ufffdyy are subject-specific constants. The functional form\nof this equation is similar to that of a leaky capacitor, with the\n\nAuthor Summary\n\nWe propose a model of thermal pain perception that\naccounts for its dynamical behavior, and can be used to\npredict subjective responses to thermal stimulation on\nindividual subjects with high accuracy, close to 90%\naveraged over subjects (over 65% for the null hypothesis).\nThe model is based on behavioral considerations that\ninclude the need to signal current or approaching tissue\ndamage, and the need to discount past danger. Moreover,\nwe show that in a \u2018mind reading\u2019 setting, the combined\nuse of sparse regression to infer pain perception from\nfunctional MRI recordings (fMRI), and from the model\napplied to the stimulus temperature also inferred from\nfMRI, leads to equally significant predictive accuracy, close\nto 75% averaged over subjects. Our results demonstrate\nthat a subjective percept such as pain displays a highly\ndeterministic behavior.\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 2 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nforcing affecting now the rate of change of perception (as opposed\n\nto the acceleration), and a restoring force that determines a unique\n\ntime-constant 1=\ufffdcc for both rising and falling of perception.\nTo test the relative merits of these models we performed\n\npsychophysical experiments, and contrasted model predictions.\n\nWe designed two stimulation types: a simple stimulus in which the\n\ntemperature ranges between a sub-threshold value and a supra-\n\nthreshold value that is maintained constant during blocks [14], and\n\na complex stimulus in which the blocks of supra-threshold\n\ntemperature are interspersed with shorter blocks of higher\n\ntemperature values [16] (see Methods for details). Figure 2A\u2013F\ndepicts an example of fitting a single subject\u2019s rating of a simple\n\nand a complex stimulus. Simple (panel E) and complex stimuli\n\n(panel F) are modeled using the first-order (panels A and B,\n\nrespectively) and second-order models (panels C and D). Observe\n\nthat while for the simple stimulus the two models appear to fit\n\nsimilarly well, the complex stimulus highlights the ability of the\n\nsecond-order model to capture the subtleties of the rating. Similar\n\nresults were seen in all subjects studied (Figure S1).\nThe results of fitting the second-order model to the perceptual\n\ndata for all participants are summarized in Figure 2G, showing\nthe fit correlation for the second-order model contrasted with the\n\nnull hypotheses. The increase of model performance over the null\n\nhypotheses is quite significant, reaching in some cases nearly 0.4,\n\nwhile the mean model correlation is above 0.9 (Wilcoxon\n\nmatched-pairs signed-ranks test, Wp, pv0:002). Similarly, the\n\ncomparison with the first-order model (Figure 2H) shows that in\nall but two cases the second-order model is a better fit to the actual\n\npain ratings (Wp, pv0:02). This increase in accuracy, however,\nmay be explained by the model\u2019s larger number of parameters (5)\n\ncompared with those for the simpler first-order model (3), and the\n\ntwo null hypotheses (1 for linear-threshold, none for linear). To\n\naccount for this, we computed the difference in the Akaike\n\nInformation Criterion (AIC) between the model and the null\n\nhypotheses. AIC regularizes the goodness of fit with a penalty for\n\nthe number of free parameters in the model; Figures 2I\u2013J show\nthe gain in AIC for the model over the null hypotheses, and the\n\nfirst-order model, respectively, suggesting that overfitting can be\n\nruled out (see Methods). To further assess our approach, we also\n\ncompared the correlation between the derivatives of the rating and\n\nof the model (Figure S2), and again we observe that the second-\norder model outperforms the null hypotheses models (Wp,\n\npv0:0002) but not the first-order model (Wp, pw0:1).\nWe also considered the robustness and generalization capability\n\nof the modeling approach with respect to other sources of\n\nvariability in the perceptual response. For that, we resorted to the\n\nconcept of predictive modeling, a statistical learning approach that\n\nhas gained increased acceptance in neuroscientific data analysis\n\n[22]: the parameters of a model are learned using training data,\n\nand then the goodness-of-fit evaluated on previously unutilized test\n\ndata, as a means to estimate the model\u2019s generalization ability. We\n\ntherefore computed the model parameters for each subject in the\n\nFigure 1. Reported perceptual pain level (blue), input temperature (dashed) and model (red). The experimental result is from [16] (their\nfig. 7). The vertical axis represents the subjective perceptual level (or applied temperature, dotted line), and the horizontal axis the time in seconds.\nThe arrows point to the most evident effects of the three different components that drive pain perception: acceleration when the temperature\nexceeds the threshold (first arrow, left), dampening of oscillations (second arrow), and temperature change-dependent acceleration and restoring\n(third and fourth arrows). The small inset depicts the functional dependence of the forcing term with the temperature, which we chose to model as a\nramp function. Time is in seconds.\ndoi:10.1371/journal.pcbi.1002719.g001\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 3 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nFigure 2. Examples of reported and modeled perception in a single subject, and adequacy of models across subjects. A\u2013F: A single\nsubject\u2019s pain rating (black) and fitted models (red), for a simple stimulus (E) using first (A) and second order (C) models, and for a complex stimulus\n(F) fitted by first (B) and second order (D) models. G\u2013H: Performance comparisons between models. G: Comparing second order model to linear\nmodels, for simple (circle) and complex (triangle) stimuli. The linear model (red) corresponds to the null hypothesis that perception follows\ntemperature, while the threshold model (blue) assumes perception follows temperature above a threshold with the temperature threshold optimized\nfor each subject. H: Comparing first and second order models. Second order model outperforms linear and first order models; circles (triangles)\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 4 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nfirst run of the experiment, and estimated the response for the\n\nsecond, independent run using the same parameters. The results\n\nshow that test and train correlations are still very similar (Figures\nS6, S7A). To understand the population effect of the stimulation\nparadigm and the modeling, we also fitted an average model of all the\n\nsubjects, and then tested generalization efficacy of this model\n\n(Figure S7B). While the simple stimulus condition is not significantly\naffected, the complex stimulus shows a large decrement in the\n\ngeneralization ability of the model, indicating that responses to\n\nhigher temporal structure are dependent on individual sensitivity\n\nparameters. A more rigorous test of generalization, however, involves\n\npredicting one class of stimuli in one run (i.e. complex in run 2) with\n\nparameters fitted to the other class and the other run (i.e. simple in\n\nrun 1). Prediction of complex stimuli with parameters fitted to simple\n\nstimuli yields a group average of r = 0.68, over r = 0.93 for the\n\nestimate. Prediction of simple for parameters fitted to complex yields\n\nr = 0.84, very similar to the average of r = 0.89 for the estimate (see\n\nFigure S7D\u2013E). The higher efficacy of the latter setup is consistent\nwith the idea that the more complex stimuli can reveal the full\n\ndynamical structure of the responses, and therefore be more robust to\n\ngeneralization.\n\nPsychophysics and Physiology\nOne of the practical applications of predictive modeling in\n\nneuroscience is its use in \u2018\u2018mind reading\u2019\u2019 setups, i.e. the possibility\n\nof obtaining precise information about perceptual and cognitive\n\nstates, such as words or images presented to subjects in the fMRI\n\nscanner, by applying a predictive model to fMRI data [22]. The\n\nability to predict and reconstruct with high accuracy external\n\nstimuli under certain conditions has proved to have enormous\n\nimplications for basic research and brain-machine applications\n\n[23\u201325]; however, predictive modeling of clinically relevant\n\nmeasures has shown to be more elusive. To further demonstrate\n\nthe relevance of our findings, we analyzed the impact of including\n\nthe analytic model in a predictive setup, as follows: (a) we trained a\npredictive linear model with regularizing constraints, the Elastic\n\nNet [26,27], to infer pain ratings from full-brain fMRI traces,\n\nutilizing TR volumes (i.e. the brain images acquired at each time\n\npoint) concurrent with the ratings as independent samples (hereby\n\nlabeled EN model); (b) we trained a model as in (a), but using up to\n7 TR volumes previous to the time the ratings are reported, and\n\nusing as predictors only voxels that have a time-lagged correlation\n\nwith the target variable above a threshold (0.2 in this case) (EN w/\n\nlags model); (c) we trained a model as in (a) and combined it\nlinearly with the analytic second order model, Eq. 1, trained on\n\nthe same data using both temperature and pain ratings (Combined\n\nmodel). Specifically, the model is trained to infer the pain ratings\n\nfrom fMRI traces, independently infer the temperature from fMRI\n\ntraces, obtain a second estimate of the pain ratings through the\n\napplication of the dynamical model to the inferred temperature,\n\nand then combine both predictions into one. Finally, (d) we\ntrained an unconstrained, linear ordinary least-squares model\n\n(OLS), with the same conditions as in (a) (Figure 3A).\n\nWith this setup, we then computed the predictive accuracy of\n\nthe combined model to infer the pain ratings on unseen test data,\n\nusing only the fMRI traces, and compared it with the predictions\n\nof the EN model, the EN w/lags model (to compensate for the\n\nintrinsic use of the recent history in the analytic model), and the\n\nOLS model (Figure 3B). The results are shown in Figure 3C\u2013D,\nwhich displays for each subject the predictive accuracy of the EN,\n\nEN w/lags and OLS models in comparison to the Combined\n\nmodel. The Combined model shows a significant improvement in\n\npredictive accuracy over the other three models, including EN w/\n\nlags, which includes delayed information and helps it to predict\n\nbetter than EN. In all cases, the increase in accuracy is statistically\n\nsignificant (Wp, pv0:01). These results demonstrate that our\ndynamical model can be successfully combined with physiological\n\nmeasurements in order to obtain further insights into the\n\nmechanisms of pain perception, and eventually used as a scaffold\n\nfor experimental manipulations. Moreover, given the high\n\naccuracy of the predictions, we conclude that \u2018\u2018mind reading\u2019\u2019 of\n\nsubjective pain perception is practically attainable.\n\nModel Consistency\nBesides the model\u2019s predictive efficacy, it is important to\n\nunderstand how consistent it is with respect to the known\n\nphenomenology. In particular, the distribution of threshold\n\ntemperatures over the population (Figures S1, S4, S5) closely\nmatches classic values determined by rigorous psychophysical\n\nmethods [28]. The other easily interpretable parameter of the\n\nmodel, the decay time-constant, also shows a reasonable distribu-\n\ntion of values, as well as a good match between the second-order\n\nand the simplified first-order models (Figures S1, S4, S5).\n\nIn order to assess the significance of each of the terms\n\ncontributing to the description of the perceptual dynamics in Eq.\n\n1 and Eq. 2, we computed all pair-wise correlations between the\n\ncorresponding fitted parameters in the second-order model. High\n\ncorrelation between two terms may indicate a redundancy in model,\n\nor perhaps an even worse inadequacy of the model to capture the\n\nessential features of the dynamics. Of all pairs (Table S1), only two\n\nreach statistical significance: between b and c(r = 0.56, p = 0.01), and\nbetween cand l (r = 20.53, p = 0.017). It is instructive to contrast\nthese values with the result of performing a similar computation\n\nwith the fitted parameters for the first-order model; in this case, the\n\ncorrelation between \ufffdaa and \ufffdcc is significant (r = 0.72, p = 0.0003). A\nparsimonious interpretation of these results is that the simplification\n\nof the dynamics introduces correlations between terms that do not\n\nproperly describe it. Given that the second-order model performs\n\nbetter, we conclude that the more complex model is also a better\n\nrepresentation of the dynamics. Moreover, while the two correla-\n\ntions are significant, their actual value (r&0.5) implies that their\ncontributions are not redundant.\n\nWe tested more radical variants of the modeling approach, in\n\norder to test its goodness-of-fit in a \u2018\u2018functional space\u2019\u2019. In\n\nparticular, Eq. 2 was expanded to incorporate two time-constants,\n\nslow and fast systems corresponding to the physiology of slow\n\n(unmyelinated) and fast conducting (myelinated) nociceptive\n\nafferents [29]; we determined that such models do not substan-\n\ntially improve prediction of pain ratings (Figure S9). In fact, the\napparent presence of two time-constants in the perceptual\n\ndynamics is accounted for, in Eq. 1, by the p _TT term, which\nmodels the decay of perception after the temperature drops below\n\nthreshold as faster than the rising time-constant (because p is\nhigher in the former than in the latter, see Figure 1).\n\ncorrespond to simple (complex) stimuli. Correlation fit, r (zero lag Pearson correlation), measures accuracy of models to pain perception ratings. Each\nsymbol/category is outcome for an individual subject. Dashed lines are the identity. I\u2013J: Akaike Information Criterion analysis for the fits shown in\npanels G\u2013H. The vertical axis corresponds to the gain in fit accuracy of the second order model over the null hypotheses (I) and the first order model\n(J), when a penalty for increased number of parameters is discounted. The color/shape is the same as for panels G\u2013H; the horizontal axis corresponds\nto different subjects.\ndoi:10.1371/journal.pcbi.1002719.g002\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 5 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nFigure 3. Scheme and performance for predictive modeling of pain ratings from brain activity. A. Depicts the learning phase, where the\nrelationships between BOLD signal and temperature, BOLD signal and perception, and temperature and perception are learned on the training data.\nB. Corresponds to the prediction phase, where for three approaches (OLS, EN and EN w/lags) the learned model is used to infer the pain rating from\nthe BOLD signal (red pathway), whereas for the Combined model the first inference is combined with the inference of temperature from BOLD, and\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 6 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nA large psychophysical body of literature shows that static\n\nratings of thermal pain, similarly to other sensory modalities,\n\nfollow S.S. Stevens\u2019s power-law for perceived magnitudes [8],\n\nsuggesting that the dependence of dynamics of pain perception on\n\ntemperature might be better modeled by a power function. As this\n\nlaw describes the stationary or steady-state response to pain, as\n\nopposed to its dynamical behavior, we cannot directly compare it\n\nagainst our model. However, we considered that it would be\n\npossible to extend the model to encompass power-law stationary\n\nresponses. Given that this requires an additional parameter (the\n\nexponent), it is more reasonable to consider an extension of Eq. 2,\n\nin which the term driven by the difference between the current\n\ntemperature and the threshold is modified by an exponent, leading\n\nto:\n\n_pp(t)~\ufffdaa Fr(T(t),T0)\n\ufffd \ufffd\n\n{cp(t) \u00f03\u00de\n\nwhere T\u00a7T0[Fr(T(t),T0)~(T{T0)\nr\n,TvT0[Fr(T(t),T0)~0,\n\nand r is an additional parameter. Performance of this new model\nwas contrasted to Eq. 2, yielding results that are comparable but\n\nslightly poorer, even though the model has one more parameter.\n\nTo summarize, the mean correlation over simple and complex\n\nstimuli was 0.90 and 0.87, compared to 0.92 and 0.88 for Eq. 2.\n\nWe also observe that as long as c and T0 are fitted for individual\nratings, proportionality constant \ufffdaa and the power parameter r\ncompensate for each other (range for r was 2.97 to 20.28,\nmean = 1.0 and SEM = 0.3), and c and T0 converge to the same\noptimal values as found for Eq. 2 (performance measure between\n\nEq. 2 and Eq. 3 using either r or SSE shows a correlation of 0.99,\n\np = 0).\n\nOur model can capture, in a single framework, perceptual\n\nbehaviors that are usually considered as disparate. Given that the\n\nperception of pain can be parceled into separate dimensions and as\n\nrecent evidence suggests that the temporal dynamics of these\n\nmodalities may have unique properties that depend on stimulus\n\nintensity [28], we examined the properties of our models for the\n\npercept of burning. When subjects were instructed to report the\n\nmagnitude of burning pain [28], we observed similar rating\n\nprofiles and model fitting to the perceived magnitude of pain,\n\nindicating that the modeling approach may be equally applicable\n\nto sub-modalities of pain.\n\nSimilarly, our model encompasses the different behaviors\n\nassociated with offset analgesia (OA). While OA is usually defined\n\nby the de-sensitization to the same noxious temperature following\n\nexposure to a more noxious one [16] (a feature essentially captured\n\nby our model, cfr. Figure 1), other more subtle features have been\nreported in the literature under the OA characterization, of which\n\nwe will consider the main two. The first one is the observation that\n\ntemperature fall rates in the range of 0.1 to 0.5uC/sec are barely\ndetected with continuous ratings of pain [16]. We tested whether\n\nour second order model will also show less sensitivity to stimulus\n\noffset rates, in comparison to the first order model, where\n\nperception fall rates should better reflect stimulus fall rates.\n\nFigure S10 shows that in fact these predictions are correct (the\nmodel closely captures pain ratings as described in figures 3 and 4\n\nin [16]). A second observation regarding OA is that pain\n\nperception magnitude for increasing intensities shows different\n\npatterns when the stimulus has an additional one degree\n\nperturbation (offset stimulus) in contrast to when the stimulus is\n\nkept at a constant level or returns to baseline [30]. Again our\n\nsecond order model captures these features better than the first\n\norder (Figure S11), and in fact our model replicates figures 2\u20135 in\n[30].\n\nMethods\n\nPsychophysics\nParticipants. Twelve healthy subjects participated in this\n\npart of the study: 6 women and 6 men (Age: 2660.3 years; mean\n\n6 S.D.). All subjects were right-handed, and all gave informed\n\nconsent to procedures approved by Northwestern University IRB\n\ncommittee.\n\nThermal stimuli and psychophysical ratings. Stimuli\n\nwere delivered to the dorsal aspect of the right arm with a\n\nthermal stimulator (363 cm Peltier) (Medoc TSA-2001; Israel).\nTwo types of stimulus series, simple and complex, were applied in\n\na randomized order at different skin locations. The simple stimulus\n\nstarted at baseline 35uC, with peak temperatures 45uC, 47uC and\n49uC, nine stimuli ranging in duration from 10 to 40 s. Durations,\nintensities, and inter-stimulus intervals were pseudo-randomized.\n\nThe complex stimuli consisted of three stimulus pulses adapted\n\nfrom [16]: from baseline 35uC sustained for 30 sec the initial peak\nwas 47uC, after 5 sec the skin temperature further increased by\n1uC sustained for 5 sec, then returned to 47uC for 20 sec. After a\n50 sec baseline adaptation, the second stimulus pulse was applied\n\nat 47uC for 35 sec. This was followed by 60 sec baseline\nadaptation and third pulse consisting of a 47uC, 5 sec stimulus\nfollowed by a 48uC, 5 sec stimulus. Stimulus rise and fall rates\nwere about 8uC/s (see Figure 2, and Figure S1).\n\nSubjects continuously rated the perceived pain intensity for\n\nsimple and complex stimuli using a finger-span device. The\n\nanchors were \u2018\u2018no pain\u2019\u2019 at the lower limit of 0 and \u2018\u2018most intense\n\npain imaginable\u2019\u2019 at 100. The finger span device was comprised of\n\na potentiometer the voltage of which was digitized and connected\n\nto a computer providing visual feedback. Participants underwent\n\nan initial training phase prior to data collection. Every subject\n\nperformed pain intensity rating for simple and complex stimuli\n\ntwice in a randomized order. These subjects were also asked to\n\nrate only the intensity of dull burning sensation evoked by the\n\nsimple or complex stimulus in two additional runs, presented in a\n\nrandomised order and interspersed between the pain intensity\n\nrating runs.\n\nModel Simulation and Parameter Estimation\nModel simulation was implemented with standard integration\n\nalgorithms in Matlab. To obtain the simplified Eq. 2 from Eq. 1,\n\nwe write\n\n\u20acpp(t)=b~aF (T(t),T0)=b{ _pp(t)zc( _TT(t){l)p(t)=b\n\nAssuming a large decay constant (equiv. a short time scale to\n\n\u2018forget\u2019), b&1 and that the effect of fast changes in the\ntemperature profile is negligible, _TT\n\n\ufffd\ufffd \ufffd\ufffd%l, we can drop the l.h.s.\nterm to write\n\nperception from temperature using the second order model (magenta pathway). C: Predictive accuracy on test data of models inferring pain\nperception ratings from brain activity. The horizontal axis represents fit correlation between predicted and actual ratings for the three inference\nmodels that do not include the analytic dynamical model (OLS, EN and EN w/lags). The vertical axis is the predictive accuracy for the Combined\nmodel. Note the marked increase in prediction accuracy for the combined model. Each symbol/category is outcome for an individual subject. Dashed\nline is identity. D. Average gain in test correlation of the combined model over the three alternative predictive models.\ndoi:10.1371/journal.pcbi.1002719.g003\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 7 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\n_pp(t)~\ufffdaaF (T(t),T0){\ufffdccp(t)\n\nWhere \ufffdaa~a=b and \ufffdcc~cl=b.\nParameter estimates for first order and second order equations\n\nwere calculated in Matlab using minimization of the least squares\n\nerror between simulation and experimental data, and a random\n\nsearch technique over the parameter space. For each stimulus\n\nrating condition, three parameters were calculated for first order\n\nfitting and five parameters for second order fitting. Adequacy of\n\nfitting was measured by zero-lag Pearson correlation between\n\nmodel output and pain ratings.\n\nOverfitting of the model was investigated using the Akaike\n\nInformation Criterion (AIC), which penalizes the measure of\n\ngoodness of fit with a term proportional to the number of free\n\nparameters [31]. When the residual squared error sum (SS) is\n\nknown, the criterion can be written as\n\nAIC~n log\nSS\n\nn\n\n\ufffd \ufffd\nz2kzC\n\nwhere n is the number of samples, and k the number of\n\nparameters. C is a constant that depends on the particular dataset\nused, but not on the model, and therefore can be ignored when\n\nmaking comparisons of AIC between models for the same data. As\neven when C is discounted, this measure still depends on the total\nnumber of samples, for presentation\u2019s sake we computed a\n\nnormalized version, which we call here the Akaike gain for the\n\nmodel (m) with respect to the contrasting null hypotheses and first-\n\norder model (c), as\n\nAG~\nAIC(c){AIC(m)\n\nn\n\nA positive value for AG indicates that the gain in accuracy of the\nmodel cannot be explained by the increase in number of\n\nparameters. For the first null hypothesis, i.e. perception propor-\n\ntional to temperature, the number of parameters is zero. The\n\nsecond null hypothesis, perception proportional to temperature\n\nover a threshold, has one free parameter that we estimate similarly\n\nto the analytic models.\n\nThe Pearson correlation between the parameters for the second-\n\norder and first-order models was computed using all fitted\n\nparameters across subjects and stimuli (Table S1).\n\nfMRI\nThe functional MRI data are the same used in an earlier study\n\n[14]. Here the thermal stimulus and related ratings of pain are\n\nused to compare results of full-brain machine learning with elastic\n\nnet for predicting pain perception with and without incorporation\n\nof our quantitative model for pain perception, Eq. 1.\n\nParticipants. Fourteen healthy subjects participated in the\n\nstudy: 7 women and 7 men (Age: 35.21611.48 years; mean 6\n\nS.D.). All subjects were right-handed, and all gave informed\n\nconsent to procedures approved by Northwestern University IRB\n\ncommittee.\n\nPain rating task. Subjects were scanned while rating their\n\npain in response to thermal stimuli applied to their back (pain\n\nrating task) using a finger-span device. Participants underwent an\n\ninitial training phase prior to scanning. The finger span device was\n\ncomprised of a potentiometer the voltage of which was digitized\n\nand time-stamped in reference to fMRI image acquisition and\n\nconnected to a computer providing visual feedback. A purpose\n\nbuilt, fMRI compatible thermal stimulator delivered painful\n\nthermal stimuli, simple sequence in the psychophysics study, was\n\napplied to the lower back at midline twice, resulting in separate\n\nfMRI data sets.\n\nfMRI data acquisition and preprocessing. Functional\n\nMR data was acquired with a 3T Siemens Trio whole-body\n\nscanner with echo-planar imaging capability using the standard\n\nradio-frequency head coil. Multi-slice T2*-weighted echo-planar\n\nimages were obtained: repetition time TR = 2.5 sec, echo time\n\nTE = 30 msec, flip angle = 90u, slice thickness = 3 mm, in-plane\nresolution = 64|64. The 36 slices covered the whole brain from\nthe cerebellum to the vertex. A T1-weighted anatomical MRI\n\nimage was also acquired for each subject using the following\n\nparameters: TR = 2.1 s, TE = 4.38 ms, flip angle = 8u,\nFOV = 220 mm, slice thickness = 1 mm, in-plane resolu-\n\ntion = 0.8660.86 mm2 and number of sagittal slices = 160.\nImage pre-processing prior to using fMRI in predicting pain\n\nperception based on changes in BOLD signal was performed on\n\neach subject\u2019s data using FMRIB Expert Analysis Tool (FEAT,\n\nwww.fmrib.ox.ac.uk/fsl). The pre-processing of time-series of\n\nfMRI volumes encompassed: skull extraction using BET; slice\n\ntime correction; motion correction; spatial smoothing using a\n\nGaussian kernel of full-width-half-maximum 5 mm; non-linear\n\nhigh-pass temporal filtering (120 seconds) and subtraction of the\n\nmean of each voxel time-course from that time-course. Six time\n\nseries obtained from rigid head motion corrections were used as\n\ncovariates of no interest, to remove residual variance due to head\n\nmotion.\n\nMachine Learning with Elastic Net (EN) to Predict Pain\nPerception from fMRI Activity\n\nHerein, we learn a predictive model individually for each\n\nsubject. We treat voxels as predictor variables, TRs as independent\n\nsamples (following [26,27]), and pain ratings as target variables,\n\nrespectively. While the independence assumption among subse-\n\nquent TRs does not hold in practice, and is used mainly for\n\nsimplicity sake, it allows us to reach good predictive accuracy. We\n\nlearn the model parameters using the first half of the experiment as\n\ntraining data, and then apply the model to the second half of the\n\nexperiments, treated here as test data.\n\nSparse predictive models were learned using a sparse regression\n\nmethod called the Elastic Net [32], which enhances the basic\n\nLASSO regression [33] by combining 1-norm (sparsity-enforcing)\n\nconstraint with the 2-norm (\u2018\u2018grouping\u2019\u2019) constraint. The rationale\n\nbehind this extension is to overcome a known limitation of the\n\nLASSO: given groups of correlated variables (e.g., spatial clusters\n\nof voxels), LASSO may pick an arbitrary one from the group, as\n\nlong as the resulting model predicts well; however, if the goal is\n\nneuro-scientific interpretation of the sparse model as a set of voxels\n\nrelevant to the task, it is important to include (or exclude) voxels as\n\ngroups (clusters) of highly-correlated variables, rather than single\n\nrepresentatives of a group. This is achieved, to some extent, by\n\ncontrolling the grouping parameter mentioned above, that tends\n\nto enforce similar coefficients among highly correlated voxels (e.g.,\n\nspatial neighbors). The Elastic Net and other models used in this\n\npaper are formally described below, and summarized in Table 1.\nOrdinary Least Squares (OLS) model. Let X1,\u2026,Xn be a\n\nset of N predictor variables (predictors), such as voxel\u2019s intensities,\n\nor BOLD signals, and let Y be the response variable, such as a pain\n\nperception rating. Let X = (x1|\u2026|xn) denote the m6n data matrix,\nwhere each x is an m-dimensional vector consisting of the values\nfor predictor Xi for m data samples, while the m-dimensional vector\n\ny denotes the corresponding values for the response variable Y. We\nconsider the problem of estimating the coefficients bi in the\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 8 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nfollowing linear regression model:\n\ny\ufffd~x1b1z . . . zxnbn~Xb \u00f04\u00de\n\nwhere y* is an approximation of y. As a baseline, we use the\nOrdinary Least Squares (OLS) regression approach which finds a\n\nset of bi that minimize the sum-squared approximation error:\n\nb\ufffd~arg minb y{Xbk k2 \u00f05\u00de\n\nWhere I.I2 represents the 2-norm. When X has the full column-\nrank (which also implies that the number of samples m is larger\n\nthan the number of variables n), OLS finds the closed-form unique\n\nsolution b* = inv (XT X) XT y, where inv() denotes the matrix\ninverse, and X\n\nT\ndenotes the matrix transpose, respectively.\n\nHowever, when n.m, as it is often the case in fMRI data with\n\nthousands of predictors (voxels) and only a few hundreds of\n\nsamples (TRs), there is no unique solution to the OLS problem,\n\nand additional constraints are required to \u2018\u2018regularize\u2019\u2019 the\n\nproblem. Moreover, predictive accuracy of OLS solutions can\n\nbe low due to over-fitting in high-dimensional, but small-sample\n\nproblems. Finally, OLS does not perform any automatic variable\n\nselection (i.e., all coefficients tend to be nonzero), so that it is hard\n\nto identify which predictors (e.g., voxels) are most relevant to the\n\nresponse variable.\n\nIn the past decades, various regularization approaches have\n\nbeen proposed in order to improve OLS models to handle\n\nproperly large-n, small-m datasets, and to avoid the over-fitting\n\n(e.g., ridge regression [34], bridge regression [35], LASSO\n\nregression [33], and so on. Specifically, recently proposed sparse\n\nregularization methods such as LASSO [33] and Elastic Net [32]\n\naddress both of the OLS shortcomings, since variable selection is\n\nembedded into their model-fitting process. Sparse regularization\n\nmethods include the 1-norm penalty on the coefficients, which is\n\nknown to produce sparse solutions, i.e. solutions with many zeros,\n\nthus eliminating predictors that are not essential.\n\nElastic net model. In this paper, we use the Elastic Net (EN)\n\nregression approach. This algorithm finds an optimal solution to\n\nthe least-squares (OLS) problem, augmented with additional\n\nregularization terms that include the sparsity-enforcing 1-norm\n\nconstraint on the regression coefficients that \u2018\u2018shrinks\u2019\u2019 some\n\ncoefficients to zero, and a \u2018\u2018grouping\u2019\u2019 2-norm constraint that\n\nenforces similar coefficients on predictors that are highly\n\ncorrelated with each other, thus allowing selection of relevant\n\ngroups of voxels, which 1-norm constraint alone is not providing.\n\nThis can improve the interpretability of the model, for example,\n\nincluding a group of similarly relevant voxels, rather than one\n\nrepresentative voxel from the group. Formally, EN regression\n\noptimizes the following function\n\nL b\u00f0 \u00de~ y{Xbk k2zl1 bk k1zl2 bk k2\n2\n, \u00f06\u00de\n\nwhere I.I1 and I.I2\n2\n\nrepresent the 1-norm and (squared) 2-\n\nnorm, respectively.\n\nIn order to solve the EN problem, we use the LARS-EN\n\nalgorithm of [32]. It takes as an input the grouping parameter l2\nand the sparsity parameter that explicitly specifies the desired\n\nnumber of selected predictors; this number corresponds to a\n\nunique value of l1 in Eq. 3. Thus, herein we will slightly abuse\nthe notation, and following [26] denote the sparsity parameter as\n\nl1 while always interpreting it as the number of selected\npredictors.\n\nEN w/lags model. When predicting a stimulus or behavior\n\nfrom fMRI data, it is typical to use as the predictors the voxels\n\nintensities at the current TR, and treat TRs as independent and\n\nidentically distributed (i.i.d.) samples [26]. While this assumption\n\ncan lead to over-estimates of accuracy under auto-correlated noise,\n\ntemporal information from the past TRs may sometimes improve\n\nthe predictive model, as we demonstrate, for example, in [27]. We\n\nconsidered as a set of predictors all voxels from the past 7 TRs,\n\nand the current TR. However, due to very high dimensionality of\n\nthis set, we selected only a subset of those voxels that were\n\ncorrelated with the response variable above the given threshold\n\n(herein, we used 0.2). (Note that time-lagged voxel\u2019s time series\n\nwere shifted forward by the appropriate lag in order to properly\n\nalign it with the response time series).\n\nCombined model. The combined model was constructed as\n\nfollows. First, we used the training fMRI data and the actual\n\ntemperature recording for the corresponding TRs in order to learn\n\nan Elastic Net regression model for predicting the temperature\n\nstimulus from fMRI. Next, given the training data for temperature\n\nand pain perception, we learned the parameters of the analytical\n\nmodel, second-order differential equation, Eq. 1. We then\n\ncombine the prediction of the EN fMRI-to-temperature-to-pain\n\nand the EN fMRI-to-pain models, learning the parameters of the\n\ncombined model similarly on the train data.\n\nTable 1. Models summary.\n\nData for Learning Data for Prediction Predicts\n\nOLS p(t) fMRI(t) p(t)\n\nfMRI(t)\n\nEN p(t) fMRI(t) p(t)\n\nfMRI(t)\n\nEN w/lags p(t) fMRI(t,t-1,..,t-7) p(t)\n\nfMRI(t,t-1,..,t-7)\n\nCombined analytic model + EN p(t,t-1) fMRI(t) p(t)\n\nT(t,t-1) T(t)\n\nfMRI(t)\n\nThe table summarizes the four predictive models considered for the inference of pain perception from the fMRI signal. Note that the combined model implicitly predicts\nthe temperature, but we have not considered it in the present article.\ndoi:10.1371/journal.pcbi.1002719.t001\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 9 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nMore explicitly, in the testing phase we assume that the\n\ntemperature is not actually known (i.e., is a \u2018\u2018hidden variable\u2019\u2019),\n\nand apply the learned EN regression model to the test fMRI data\n\nin order to predict the temperature stimulus. We then apply the\n\nanalytical model (Eq. 1) to predict the pain perception given the\n\npredicted temperature, and combine this prediction with the direct\n\nEN regression model for pain in order to obtain the final\n\nprediction.\n\nTraining and testing. The data from the pain-stimulus\n\nrating session were split into the training and test subsets: the data\n\nassociated with the first 120 TRs were used for training the\n\nmodels, while the remaining 120 TRs were used for testing the\n\npredictive accuracy. The accuracy of the model was measured by\n\nthe Pearson\u2019s correlation coefficient between the response variable\n\n(pain rating) and its prediction by the model.\n\nDiscussion\n\nModel Efficacy\nThe results show that acute thermal pain perception applied to\n\nhealthy skin follows simple quantitative deterministic patterns. The\n\ndynamic model is derived from a behaviorally relevant interpre-\n\ntation of pain perception as a warning signal that quickly reports\n\nimmediate threat of injury (temperature above threshold), and\n\napproaching danger (rapid temperature increases), and can also as\n\neasily discount the threat once it goes away or it is expected to do\n\nso (temperature decreases). The model, using few parameters, can\n\nreproduce with high accuracy the dynamical transformation from\n\nstimulus to perception. Moreover, the model also has high\n\npredictive accuracy, and accounts for subjects\u2019 variability with\n\nsimple and interpretable mechanisms.\n\nThe model provides a summary of a relatively complex\n\nbehavior, whose physiological correlates and mechanisms can be\n\ndirectly investigated through pharmacological manipulation and\n\nthe design of targeted stimulus conditions. Temporal processing is\n\nubiquitous in sensory systems, including the somatosensory\n\npathway [36,37]. However, it is only in a few cases that spatio-\n\ntemporal transformations can be functionally interpreted, beyond\n\ngeneric sharpening for enhanced localization [38], or information\n\ncompression [39]. We do not consider, however, that the\n\nperceptual dynamics captured by our model can be reduced to\n\nperipheral processing. In fact, as previously reported [14], the\n\nBOLD response to a task similar to the one used in this report\n\nreveals a rich temporal structure across several cortical and sub-\n\ncortical areas compatible with the time scale of the perceptual\n\nratings, such that the dynamics of pain perception may result from\n\nthe emergent interaction of extensive networks. Moreover, given\n\nits ultimately non-linear nature, the model further predicts\n\ndynamical features of pain perception that may have unexpected\n\nbehavioral relevance (see Text S1).\n\nThe utilization of our analytic model within the \u2018\u2018mind reading\u2019\u2019\n\nsetup highlights its predictive efficacy, and provides an additional\n\nvalidation step. A further reason for using the combined model,\n\nbesides simply inferring pain from fMRI, is to go beyond the\n\nlimitation of simple linear inference models such as Elastic Net, while\n\nkeeping the non-linear model simple, tractable and interpretable.\n\nGiven the nature of brain processes, we expect the true relationship\n\nbetween the high-dimensional fMRI signal and pain ratings to be a\n\ncomplex non-linear one. However, fitting an ad hoc non-linear\n\nmodel (e.g., a neural network) to such high-dimensional data to\n\npredict pain rating directly could be computationally much more\n\nchallenging than fitting a linear one. On the other hand, given an\n\naccurate analytical model linking temperature to pain, we may\n\nexploit it advantages in our combined nonlinear method, first\n\nobtaining an estimate of the temperature from fMRI data via simple\n\nand computationally efficient linear regression, and then using\n\nnonlinear model predicting pain from temperature. Though the\n\ncombined predictive model involves inferring temperature as a\n\nhidden variable, it outperforms the direct EN model because it\n\ncaptures (at least the temperature-to-pain part of) the non-linear\n\nrelationship between fMRI and pain perception. To some extent, we\n\ncan consider the analytic model as a principled constraint in the\n\ntemporal domain, similar to the spatial regularization imposed by\n\nEN.\n\nCaveats, Limitations and Outlook\nOur model can only provide a limited description of the full\n\ncomplexity of pain perception. In particular, the model accurately\n\ncaptures the perceptual dynamics in the time scale of seconds to\n\nminutes, most relevant for the functional interpretation of thermal\n\npain as an \u2018\u2018alarm signal\u2019\u2019. Processes whose dynamics develop over\n\nlonger time scales, such as habituation, sensitization, post-tissue\n\ninjury, or following acute or chronic pain conditions [8,11] are\n\nbeyond the model\u2019s descriptive capabilities. For instance, repeated\n\ntesting of offset analgesia over multiple days in [16] results in\n\nsensitization changes, which however do not alter the quality of\n\nthe responses. Nevertheless, our model can provide an analytic\n\nframework even in the context of these long-term adaptive\n\nprocesses, as it will be possible to study the effect of adaptation on\n\nthe different parameters that control the short-term perceptual\n\ndynamics, for instance threshold and decay time-constant.\n\nAnother class of perceptual behaviors that our model does not\n\nconsider, unrelated to differences in time scale, are those derived\n\nfrom interactions between pain and cognitive and attention\n\nprocesses, which can significantly modulate the perception to\n\nobjectively similar noxious stimuli [40\u201341].\n\nDespite its limitations, the model provides a powerful tool with\n\nwhich peripheral and central mechanisms can be studied. As the\n\nmodel describes subjective reports of magnitude of pain, it may\n\nalso generalize to magnitude perception across other sensory\n\nmodalities. Moreover, as we have tentatively shown with the\n\ncombined model of fMRI-based prediction, it should be possible to\n\nidentify physiological processes associated with the proposed\n\ncomponents of the perceptual dynamics, and so reduce the gap\n\nbetween phenomenology and theory.\n\nSupporting Information\n\nFigure S1 Individual subjects and group averaged pain\nratings and corresponding models. Pain rating are shown in\nblue for simple (first two columns) and complex stimulus (3\n\nrd\nand\n\n4\nth\n\ncolumns), fitted (red) with first (columns 1 and 3) and second\n\norder models (columns 2 and 4), corresponding parameters (first-\n\norder model: a,l,T0; second-order model: a,b,c,k,T0) and fit\ncorrelations (r) are also presented. Stimulus temperature profiles\n\nare shown on top in green. A. Each row is a single subject. B.\nGroup-averaged pain perception and calculated models. Note that\n\ngroup-averaged pain ratings for simple stimuli show better fit\n\ncorrelations than the individual subject models for the simple\n\nstimulus, and first-order and second-order models are essentially\n\nequivalent and show 97% similarity to the group-averaged pain\n\nrating. This is not the case for the second order model, due to its\n\nnon-linear properties.\n\n(TIFF)\n\nFigure S2 A time expansion of part of fig. 2 for the\nsimple stimulus. Stimulus and pain ratings are shown in balck,\nand first (top panel) and second (middle panel) order models are in\n\nred. The first order model consistently over estimates pain relief\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 10 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\ntime profile, while the second order model captures this more\n\naccurately (compare corresponding arrows between top and\n\nbottom panels). Note that model performance measures do not\n\ncapture such details as variability of rating within and across\n\nsubjects dominates such measures.\n\n(TIFF)\n\nFigure S3 Comparison between models and null hy-\npotheses for fit correlations between the time derivative\nof the actual and modeled perception traces. Panel A.\ncomparison between the linear models and the 2nd order model, for\n\nsimple and complex stimuli (circles and triangles, respectively). The\n\nlinear model corresponds to the null hypothesis that perception\n\nfollows temperature, while the threshold model assumes perception\n\nfollows temperature above a threshold; the temperature threshold is\n\noptimized for each subject. But for a few cases (7 of 48), the second\n\norder model outperforms the linear and threshold models. Panel B.\n\nSame as Panel A, but the horizontal axis corresponds to the time\n\nderivative of the first order model. The first order model outperforms\n\nthe second order model in 6 of 24 cases (this difference is statistically\n\nnot significant, Wp, p.0.1). Data points correspond to values for\n\neach subject, and the dashed line to the identity.\n\n(TIFF)\n\nFigure S4 Histograms of distributions of parameter\nvalues for all subjects and for simple and complex stimuli.\nPanel A: distribution of the 3 parameters for the first order model.\n\nPanel B: distribution of the 5 parameters for the second order model.\n\n(TIFF)\n\nFigure S5 Calculated threshold to pain and time\nconstant are similar for first and second order models.\nLeft panel is the correlation of temperature threshold parameter\n\n(in degrees centigrade) between first and second order models, for\n\nsimple and complex stimuli. Right panel is the time constant\n\ncomparison between the two models (1=c for the first order model,\nand 1=b for the second order model) for the simple stimulus.\n(TIFF)\n\nFigure S6 Individual subjects perception and predicted\nperception based on parameters estimated from a\nprevious pain rating. Each row is an individual subject.\nParameters estimated from pain rating run 1 are used to model\n\nperception for run 2 in each subject. Fit correlations are shown for\n\neach prediction. Column 1 is for simple stimulus using estimation\n\nfrom first order model (estimations are shown in Fig. S2, column\n\n1); column 2 is the same data using estimations from second order\n\nmodel (column 2 in Fig. S2). Columns 3 and 4 are similar for the\n\ncomplex stimulus. Simple and complex stimuli are very well\n\npredicted for each subject by first and second order models.\n\n(TIFF)\n\nFigure S7 Estimation and prediction relationship for\nindividual subjects and group averages. Panel A. The\nhorizontal axis shows the fit correlation between pain perception\n\nand the best second order model for each subject (training, run 1,\n\nparameters estimated from this run); the vertical axis is the\n\ncorrelation between actual perception and predicted perception\n\nfor a second independent pain rating (run 2), with the parameters\n\nlearned from run 1 (test correlation). Open and full circles\n\ncorrespond to simple and complex stimuli conditions, respectively.\n\nAs expected, test correlations, i.e. predictions, tend to be less\n\naccurate than training correlations. Panel B. Same as Panel A, but\n\nfor parameters learned for the average response to the first run. In\n\nthis case, predictions for complex stimuli are less accurate, as they\n\nreveal more clearly individual differences between the subjects.\n\nPanel C. Prediction of first order model for simple stimuli in run 2,\n\nbased on estimates of complex stimuli on run1. Panel D.\n\nPrediction of second order model for complex stimuli in run 2,\n\nbased on estimates for simple stimuli in run 1.Panel E. Prediction\n\nof second order model for simple stimuli in run 2, based on\n\nestimates for complex stimuli in run 1.\n\n(TIFF)\n\nFigure S8 Rating intensity of burning pain or intensity\nof pain result in comparable models. Panel A. Group\naverage perception (n = 12 subjects) and predicted perception with\n\ncorresponding estimated parameters for rating intensity of\n\nburning. Panel B. Group average for rating intensity of perceived\n\npain (same as Figure S1B). Parameters and fit correlations are\nsimilar for both sets of instructions.\n\n(TIFF)\n\nFigure S9 Comparison between the two-time-constant\nmodel and the second order model, for simple and\ncomplex stimuli. Fit correlations were tested for equality, Wp,\np.0.1, implying no difference between the two models.\n\n(TIFF)\n\nFigure S10 Prediction of offset analgesia I. We use group-\naveraged parameters (Figure S1) for the two models and apply the\n\nstimuli reported in figure 3 of Yelle et al. Panel A: patterns of\n\ntemperature stimulation with different fall rates, from 0.5 to 5uC/\nsec. The 5 different patterns are color-coded. Panel B: result of\n\nsimulating the first order model with group-averaged parameters\n\nand the stimulation patterns shown in Panel A. Panel C: same as\n\nPanel B, for the second order model.\n\n(TIFF)\n\nFigure S11 Prediction of offset analgesia II. Same as\nFigure S10, for stimuli reported in figure 1 of Derbyshire and\n\nOsborn. Panels A, D and G: temperature stimulation patterns.\n\nThe colors indicate the plateau temperature reached. Panels B, E\n\nand H: result of simulating the first order model with the group-\n\naverage parameters, for the corresponding stimulation patterns in\n\nthe left column panels. Panels C, F and I: same as the center\n\ncolumn panels, for the second order model.\n\n(TIFF)\n\nFigure S12 Interpretation of the model I. Panel A: a\nperception signal delayed with respect to the temperature may\n\nintegrate the error to zero, while the p _TT term is positive;\nconversely, an advanced perception signal will integrate the same\n\nterm to a negative value. Panel B: the delayed signal implies a\n\nclockwise trajectory in the pT plane, leading to a positive integral\nfor pdT ; the converse is true for an advanced signal.\n\n(TIFF)\n\nFigure S13 Interpretation of the model II. Panel A:\nIntegration of the full Eq. 1 model (red trace), and a model\n\nwithout the p _TT term (blue trace), for a temperature that consists of\na mean above threshold and an oscillation on top of it (green\n\ntrace). Panel B: Fourier analysis of the traces around the main\n\nfrequency. The line traces correspond to the logarithm of the\n\npower, while the circles are the phases for each frequency.\n\n(TIFF)\n\nTable S1 Correlation between fitted parameters for the\nsecond- and first-order models. Statistically significant\ncorrelations are indicated in bold-face.\n\n(RTF)\n\nText S1 Description of additional data, including fits\nto individual perception traces, and further compari-\nsons between the proposed models. An interpretation of\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 11 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n\nthe second order model in terms of signal processing is also\n\nincluded.\n\n(DOCX)\n\nAuthor Contributions\n\nConceived and designed the experiments: AVA MB GAC. Performed the\n\nexperiments: MB JAH MVC. Analyzed the data: LH MB GAC IR.\n\nContributed reagents/materials/analysis tools: AVA GAC IR. Wrote the\n\npaper: AVA GAC.\n\nReferences\n\n1. Perl ER (2011) Pain mechanisms: a commentary on concepts and issues. Prog\n\nNeurobiol 94: 20.\n2. Finger S (2001) Origins of Neuroscience: A history of explorations into brain\n\nfunction. London: Oxford University Press.\n\n3. Wittgenstein L (1953) Philosophical investigations. Oxford: Blackwell Publishing\n(English Translation 2001).\n\n4. Dennett DC (1978) Why you can\u2019t make a computer that feels pain. Synthese\n38: 415.\n\n5. Merskey H, Bogduk N (1994) Classification of chronic pain. 2nd edition. Seattle:\nInternational Association for the Study of Pain.\n\n6. Weber EH (1978) The sense of touch. London: Academic Press.\n\n7. Stevens SS (1957). On the psychophysical law. Psychol Rev 64: 153.\n8. Price DD (1988), Psychological and neural mechanisms of pain. New York:\n\nRaven Press.\n9. Hansson P, Haanpaa M (2007). Diagnostic work-up of neuropathic pain:\n\ncomputing, using questionnaires or examining the patient? Eur J Pain 11: 367.\n\n10. Cruccu G et al. (2004) EFNS guidelines on neuropathic pain assessment.\nEur J Neurol 11: 153.\n\n11. Hardy JD, Stolwijk AJ, Hoffman D, Kenshalo DR (1968) Pain following step\nincrease in skin temperature. The skin senses. pp. 444\u2013456. Springfield:\n\nThomas.\n\n12. Ahlquist ML, Edwall LG, Franzen OG, Haegerstam GA (1984) Perception of\npulpal pain as a function of intradental nerve activity. Pain 19: 353\u2013366.\n\n13. Vierck CJ, Cooper BY, Franzen D, Ritz LA, Greenspan JD (1983) Behavioral\nanalysis of CNS pathways and transmitter systems involved in conduction and\n\ninhibition of pain sensations and reactions in primates. In: Progress in\nPsychobiology. New York: Academic Press.\n\n14. Baliki MN, Geha PY, Apkarian AV (2009) Parsing pain perception between\n\nnociceptive representation and magnitude estimation. J Neurophysiol 101: 875\u2013887.\n15. Handwerker H, Schoedel A, Zimmermann K, Forster C (2005) How do pain\n\nratings change the brain activation by painful stimuli measured with fMRI?\nSociety for Neuroscience Abstracts.\n\n16. Yelle MD, Rogers JM, Coghill RC (2008) Offset analgesia: a temporal contrast\n\nmechanism for nociceptive information. Pain 134: 174\u2013186.\n17. Davis KD, Pope GE, Crawley AP, Mikulis DJ (2002) Neural correlates of prickle\n\nsensation: a percept-related fMRI study. Nat Neurosci 5: 1121\u20131122.\n18. Davis KD, Pope GE, Crawley AP, Mikulis DJ (2004) Perceptual illusion of\n\n\u2018\u2018paradoxical heat\u2019\u2019 engages the insular cortex. J Neurophysiol 92: 1248\u20131251.\n19. Yelle MD, Oshiro Y, Kraft RA, Coghill RC (2009) Temporal filtering of\n\nnociceptive information by dynamic activation of endogenous pain modulatory\n\nsystems. J Neurosci 29: 10264\u201310271.\n20. Amris K, Waehren EE, Jespersen A, Bliddal H, Danneskiold-Samsoe B (2011)\n\nObservation-based assessment of functional ability in patients with chronic\nwidespread pain: A cross-sectional study. Pain 152: 2470\u20132476.\n\n21. Morley S (2008) Psychology of pain. Br J Anaesth 101: 25\u201331.\n\n22. Mitchell TM, et al. (2008) Predicting human brain activity associated with the\nmeanings of nouns. Science 320: 1191\u20131195.\n\n23. Kay KN, Naselaris T, Prenger RJ, Gallant JL (2008) Identifying natural images\n\nfrom human brain activity. Nature 452: 352\u2013355.\n24. Wager TD, Atlas LY, Leotti LA, Rilling JK (2011) Predicting individual\n\ndifferences in placebo analgesia: Contributions of brain activity during\n\nanticipation and pain experience. J Neurosci 31: 439\u2013452.\n25. Brown JE, Chatterjee N, Younger J, Mackey S (2011) Towards a physiology-\n\nbased measure of pain: patterns of human brain activity distinguish painful from\nnon-painful thermal stimulation. PLoS ONE 6: e24124.\n\n26. Carroll MK, Cecchi GA, Rish I, Garg R, Rao AR (2009) Prediction and\ninterpretation of distributed neural activity with sparse models. Neuroimage 44:\n\n112\u2013122.\n\n27. Rish I, Cecchi GA, Baliki MN, Apkarian AV (2010) Sparse regression models of\npain perception. Lect N Comp Sci 6334: 212\u2013223.\n\n28. Hashmi JA, Davis KD (2008) Effect of static and dynamic heat pain stimulus\nprofiles on the temporal dynamics and interdependence of pain qualities,\n\nintensity, and affect. J Neurophysiol 100: 1706\u20131715.\n\n29. Basbaum AI, Bautista DM, Scherrer G, Julius D (2009) Cellular and molecular\nmechanisms of pain. Cell 139: 267\u2013284.\n\n30. Derbyshire SWG, Osborn J (2008) Enhancement of offset analgesia during\nsequential testing. Eur J Pain 12: 980\u2013989.\n\n31. Burnham KP, Anderson DR (2002) Model selection and multimodel\n\ninference: A practical information-theoretic approach. New York: Springer-\nVerlag.\n\n32. Zou H, Hastie T (2005) Regularization and variable selection via the Elastic Net.\nJ Royal Stat Soc B 67: 301\u2013320.\n\n33. Tibshirani R (1996) Regression shrinkage and selection via the lasso. J Royal\nStat Soc B 58: 267\u2013288.\n\n34. Hoerl A, Kennard R (1988) Ridge regression. Encyclopedia of Statistical\n\nSciences 8: 129\u2013136.\n35. Fu W (1998) Penalized regression: the bridge versus the lasso. J Comput Graph\n\nStatist 7: 397\u2013416.\n36. Phillips JR, Johnson KO, Hsiao SS (1988) Spatial pattern representation and\n\ntransformation in monkey somatosensory cortex. Proc Natl Acad Sci U S A 85:\n\n1317\u20131321.\n37. Romo R, Salinas E (2001) Touch and go: decision-making mechanisms in\n\nsomatosensation, Annu Rev Neurosci 24: 107\u2013137.\n38. Gabernet L, Jadhav SP, Feldman DF, Carandini M, Scanziani M (2005)\n\nSomatosensory integration controlled by dynamic thalamocortical feed-forward\ninhibition. Neuron 48: 315\u2013327.\n\n39. Dan Y, Atick JJ, Reid RC (1996) Efficient coding of natural scenes in the lateral\n\ngeniculate nucleus: experimental test of a computational theory. J Neurosci 16:\n3351\u20133362.\n\n40. Miron D, Duncan GH, Bushnell MC (1989) Effects of attention on the intensity\nand unpleasantness of thermal pain. Pain 39: 345\u2013352.\n\n41. Bantick SJ, Wise RG, Ploghaus A, Clare S, Smith SM, Tracey I (2002) Imaging\n\nhow attention modulates pain in humans using functional MRI. Brain 125: 310\u2013\n319.\n\nDynamics of Pain\n\nPLOS Computational Biology | www.ploscompbiol.org 12 October 2012 | Volume 8 | Issue 10 | e1002719\n\n\n", "status": 200, "abstract": "While the static magnitude of thermal pain perception has been shown to follow a power-law function of the temperature,its dynamical features have been largely overlooked. Due to the slow temporal experience of pain, multiple studies nowshow that the time evolution of its magnitude can be captured with continuous online ratings. Here we use such ratings tomodel quantitatively the temporal dynamics of thermal pain perception. We show that a differential equation captures thedetails of the temporal evolution in pain ratings in individual subjects for different stimulus pattern complexities, and alsodemonstrates strong predictive power to infer pain ratings, including readouts based only on brain functional images."}